<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grimório de Itens Mágicos - D&D 5e</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=MedievalSharp&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --incomum: #4CAF50;
            --raro: #2196F3;
            --muito-raro: #9C27B0;
            --lendario: #FF9800;
            --dark-bg: #1a0a0e;
            --dark-purple: #2d1b33;
            --medium-purple: #3a2442;
            --light-purple: #5d3a71;
            --gold: #e9c46a;
            --text-light: #e0d4c3;
            --success: #4CAF50;
            --danger: #f44336;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--dark-purple) 100%);
            color: var(--text-light);
            font-family: 'Roboto', sans-serif;
            min-height: 100vh;
            padding: 15px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232d1b33"/><path d="M0 0L100 100M100 0L0 100" stroke="%233a2442" stroke-width="1"/></svg>');
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Seção de Login */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
            text-align: center;
            padding: 20px;
        }
        
        .login-box {
            background: rgba(26, 15, 33, 0.9);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--light-purple);
            max-width: 500px;
            width: 100%;
        }
        
        .login-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--gold);
            text-shadow: 0 0 8px rgba(233, 196, 106, 0.5);
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-family: 'MedievalSharp', cursive;
            color: var(--gold);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            background: rgba(58, 36, 66, 0.6);
            border: 1px solid var(--light-purple);
            border-radius: 6px;
            color: var(--text-light);
            font-family: 'Roboto', sans-serif;
            font-size: 1rem;
        }
        
        .btn {
            padding: 12px 20px;
            background: var(--light-purple);
            color: white;
            border: none;
            border-radius: 30px;
            font-family: 'MedievalSharp', cursive;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--lendario) 0%, #F57C00 100%);
            font-size: 1.1rem;
            padding: 14px 20px;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(93, 58, 113, 0.4);
        }
        
        .user-type-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .user-type-btn {
            flex: 1;
            padding: 12px;
            background: var(--medium-purple);
            border: 2px solid var(--light-purple);
            color: #d4c4e4;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-family: 'MedievalSharp', cursive;
        }
        
        .user-type-btn.active {
            background: var(--light-purple);
            color: #f8f0c6;
            border-color: var(--gold);
        }
        
        .error-message {
            color: var(--danger);
            margin-top: 5px;
            font-size: 0.9rem;
        }
        
        /* Barra de usuário logado */
        .user-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: rgba(26, 15, 33, 0.8);
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid var(--light-purple);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--medium-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .user-name {
            font-family: 'MedievalSharp', cursive;
            color: var(--gold);
        }
        
        .user-role {
            background: var(--lendario);
            color: #fff3e0;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
        }
        
        .logout-btn {
            background: var(--danger);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        /* Conteúdo principal */
        header {
            text-align: center;
            padding: 20px 15px;
            margin-bottom: 20px;
            background: rgba(26, 15, 33, 0.8);
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--light-purple);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24"><path fill="%235d3a7150" d="M12,2L2,7L12,12L22,7L12,2M2,17L12,22L22,17M2,12L12,17L22,12L12,7Z"/></svg>');
            opacity: 0.3;
            z-index: -1;
        }
        
        h1 {
            font-family: 'Cinzel', serif;
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: var(--gold);
            text-shadow: 0 0 8px rgba(233, 196, 106, 0.5);
            letter-spacing: 1px;
            line-height: 1.2;
        }
        
        .subtitle {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.1rem;
            color: #b8a7c1;
            max-width: 700px;
            margin: 0 auto 15px;
            line-height: 1.4;
        }
        
        .player-filters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin: 20px 0;
        }
        
        .player-btn {
            padding: 10px 15px;
            font-family: 'MedievalSharp', cursive;
            background: var(--medium-purple);
            border: 2px solid var(--light-purple);
            color: #d4c4e4;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 6px;
            flex: 1 0 auto;
            max-width: 48%;
            justify-content: center;
            text-align: center;
        }
        
        .player-btn i {
            font-size: 1.1rem;
        }
        
        .player-btn:hover, .player-btn.active {
            background: var(--light-purple);
            color: #f8f0c6;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(93, 58, 113, 0.4);
        }
        
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .item-card {
            background: linear-gradient(145deg, #2a1a30 0%, #1e1125 100%);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
            border: 2px solid var(--medium-purple);
        }
        
        .item-card:hover {
            transform: translateY(-6px) scale(1.01);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.6);
        }
        
        .card-header {
            padding: 15px;
            border-bottom: 1px solid var(--medium-purple);
            position: relative;
        }
        
        .item-player {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(58, 36, 66, 0.8);
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-family: 'MedievalSharp', cursive;
            color: var(--gold);
            max-width: 100px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .item-name {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: var(--gold);
            margin-bottom: 5px;
            padding-right: 90px;
            line-height: 1.3;
            text-align: right;
            margin-left: 3px;
        }
        
        .item-type {
            font-family: 'MedievalSharp', cursive;
            color: #b8a7c1;
            font-size: 0.95rem;
        }
        
        .item-image {
            height: 180px;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .item-image::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.5) 100%);
        }
        
        .item-content {
            padding: 15px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .item-description {
            line-height: 1.5;
            margin-bottom: 15px;
            flex-grow: 1;
            font-size: 0.95rem;
        }
        
        .benefits-section {
            background: rgba(58, 36, 66, 0.6);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 3px solid var(--gold);
        }
        
        .benefits-title {
            font-family: 'MedievalSharp', cursive;
            color: var(--gold);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .benefits-list {
            padding-left: 18px;
            font-size: 0.9rem;
        }
        
        .benefits-list li {
            margin-bottom: 6px;
            line-height: 1.4;
        }
        
        .item-stats {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            background: rgba(58, 36, 66, 0.6);
            padding: 10px;
            border-radius: 8px;
            font-family: 'MedievalSharp', cursive;
            border: 1px solid var(--light-purple);
            margin-top: auto;
            gap: 8px;
        }
        
        .item-rarity {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.85rem;
        }
        
        .incomum {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: #e8f5e9;
        }
        
        .raro {
            background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);
            color: #e3f2fd;
        }
        
        .muito-raro {
            background: linear-gradient(135deg, #9C27B0 0%, #6A1B9A 100%);
            color: #f3e5f5;
        }
        
        .lendario {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            color: #fff3e0;
        }
        
        .item-attunement {
            color: var(--gold);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* Bordas personalizadas por raridade */
        .item-card.incomum {
            border: 2px solid var(--incomum);
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
        }
        
        .item-card.raro {
            border: 2px solid var(--raro);
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.3);
        }
        
        .item-card.muito-raro {
            border: 2px solid var(--muito-raro);
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.3);
        }
        
        .item-card.lendario {
            border: 2px solid var(--lendario);
            box-shadow: 0 0 10px rgba(255, 152, 0, 0.4);
        }
        
        .item-card.lendario .item-name {
            text-shadow: 0 0 6px rgba(255, 152, 0, 0.6);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 15px;
            box-sizing: border-box;
            overflow-y: auto;
        }
        
        .modal-content {
            background: linear-gradient(145deg, #2a1a30 0%, #1e1125 100%);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.7);
            border: 2px solid var(--light-purple);
            position: relative;
            overflow-y: auto;
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5rem;
            color: var(--gold);
            background: none;
            border: none;
            cursor: pointer;
            z-index: 10;
        }
        
        .modal-title {
            font-family: 'Cinzel', serif;
            color: var(--gold);
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
            padding: 0 30px;
        }
        
        /* Estilos adicionados para o upload de imagem */
        .image-upload-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .image-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .image-preview {
            width: 100%;
            height: 150px;
            background-color: rgba(58, 36, 66, 0.6);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            border: 1px solid var(--light-purple);
            border-radius: 5px;
            margin-top: 5px;
        }
        
        .image-preview-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #b8a7c1;
            text-align: center;
            padding: 10px;
        }
        
        .image-preview-placeholder i {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            font-family: 'MedievalSharp', cursive;
            color: #b8a7c1;
            border-top: 1px solid var(--medium-purple);
            font-size: 0.9rem;
        }
        
        /* Botões de Ação */
        .action-button {
            background: linear-gradient(135deg, #8B4513 0%, #5D2906 100%);
            border: 2px solid #e9c46a;
            color: #f8f0c6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: absolute;
            z-index: 2;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .action-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.7);
            background: linear-gradient(135deg, #a0522d 0%, #6b3a1a 100%);
        }

        .edit-item-btn {
            top: 8px;
            left: 8px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23e9c46a"><path d="M3 17.25v3.75h3.75l11.06-11.06-3.75-3.75-11.06 11.06zm17.71-10.21c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>');
            background-size: 60%;
            background-repeat: no-repeat;
            background-position: center;
        }

        .add-item-btn {
            bottom: 20px;
            right: 20px;
            position: fixed;
            width: 60px;
            height: 60px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23e9c46a"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>');
            background-size: 60%;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* Remover o ícone padrão do Font Awesome dos botões de ação */
        .action-button i {
            display: none;
        }
        
        /* Responsividade Mobile */
        @media (max-width: 768px) {
            .items-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .player-btn {
                font-size: 0.9rem;
                padding: 8px 12px;
            }
            
            .item-name {
                font-size: 1.4rem;
            }
            
            .modal-content {
                padding: 15px;
            }
            
            .modal-title {
                font-size: 1.6rem;
                margin-bottom: 15px;
            }
            
            .form-row {
                gap: 8px;
            }
            
            .form-row .form-group {
                flex: 1 1 100%;
            }
            
            .login-box {
                padding: 25px;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .player-filters {
                gap: 6px;
            }
            
            .player-btn {
                max-width: 100%;
                font-size: 0.85rem;
                padding: 8px 10px;
            }
            
            .item-player {
                font-size: 0.75rem;
                max-width: 80px;
            }
            
            .item-name {
                font-size: 1.3rem;
                padding-right: 80px;
            }
            
            .item-image {
                height: 160px;
            }
            
            .item-description {
                font-size: 0.9rem;
            }
            
            .benefits-list {
                font-size: 0.85rem;
            }
            
            .item-stats {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }
            
            .add-item-btn {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
            }
            
            .user-bar {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .login-box {
                padding: 20px;
            }
        }
        
        @media (max-width: 350px) {
            h1 {
                font-size: 1.6rem;
            }
            
            .item-name {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Seção de Login (visível apenas quando não logado) -->
        <div id="login-section" class="login-container">
            <div class="login-box">
                <h2 class="login-title"><i class="fas fa-dragon"></i> Grimório de Artefatos</h2>
                <p class="subtitle">Entre para acessar seus itens mágicos</p>
                
                <div class="user-type-selector">
                    <div class="user-type-btn active" data-role="master">
                        <i class="fas fa-crown"></i> Mestre
                    </div>
                    <div class="user-type-btn" data-role="player">
                        <i class="fas fa-user"></i> Jogador
                    </div>
                </div>
                
                <form class="login-form">
                    <div class="form-group">
                        <label for="login-email"><i class="fas fa-envelope"></i> Email</label>
                        <input type="email" id="login-email" class="form-control" placeholder="seu@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password"><i class="fas fa-lock"></i> Senha</label>
                        <input type="password" id="login-password" class="form-control" placeholder="••••••••" required>
                    </div>
                    
                    <div class="form-group">
                        <button type="button" id="login-btn" class="btn btn-primary">
                            <i class="fas fa-sign-in-alt"></i> Entrar no Grimório
                        </button>
                    </div>
                    
                    <div id="login-error" class="error-message" style="display: none;">
                        Credenciais inválidas. Tente novamente.
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Conteúdo principal (visível apenas quando logado) -->
        <div id="app-content" style="display: none;">
            <!-- Barra de usuário -->
            <div class="user-bar">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div class="user-name" id="current-user-name">Usuário</div>
                        <div class="user-role" id="current-user-role">Jogador</div>
                    </div>
                </div>
                <button id="logout-btn" class="btn logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
            
            <header>
                <h1><i class="fas fa-book-dead"></i> Grimório de Artefatos Mágicos</h1>
                <p class="subtitle">Registro completo dos itens mágicos dos seus aventureiros de D&D 5e</p>
                
                <div class="player-filters">
                    <button class="player-btn active" data-player="all">
                        <i class="fas fa-users"></i> Todos
                    </button>
                    <button class="player-btn" data-player="Deini">
                        <i class="fas fa-shield-alt"></i> Deini
                    </button>
                    <button class="player-btn" data-player="Felipe">
                        <i class="fas fa-mask"></i> Felipe
                    </button>
                    <button class="player-btn" data-player="Maki">
                        <i class="fas fa-hat-wizard"></i> Maki
                    </button>
                    <button class="player-btn" data-player="Mauricio">
                        <i class="fas fa-fire"></i> Mauricio
                    </button>
                </div>
            </header>
            
            <main>
                <div class="items-grid" id="items-container">
                    <!-- Itens serão carregados aqui pelo JavaScript -->
                </div>
            </main>
            
            <footer>
                <p>Grimório de Itens Mágicos - D&D 5e | © 2025 Alexandre - Curse of Sthrad</p>
                <p>Os itens apresentados são fictícios e criados para fins de entretenimento</p>
            </footer>
            
            <!-- Botão para adicionar novo item (visível apenas para mestres) -->
            <button class="action-button add-item-btn" id="add-item-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
    </div>
    
    <!-- Modal para adicionar/editar itens -->
    <div class="modal" id="item-modal">
        <div class="modal-content">
            <button class="close-btn" id="close-modal">&times;</button>
            <h2 class="modal-title" id="modal-title">Adicionar Novo Item Mágico</h2>
            
            <form id="item-form">
                <input type="hidden" id="item-id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-name">Nome do Item</label>
                        <input type="text" id="item-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="item-player">Jogador</label>
                        <select id="item-player" class="form-control" required>
                            <option value="">Selecione um jogador</option>
                            <option value="Deini">Deini</option>
                            <option value="Felipe">Felipe</option>
                            <option value="Maki">Maki</option>
                            <option value="Mauricio">Mauricio</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="item-type">Tipo de Item</label>
                        <input type="text" id="item-type" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="item-rarity">Raridade</label>
                        <select id="item-rarity" class="form-control" required>
                            <option value="">Selecione a raridade</option>
                            <option value="incomum">Incomum</option>
                            <option value="raro">Raro</option>
                            <option value="muito-raro">Muito Raro</option>
                            <option value="lendario">Lendário</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="item-description">Descrição</label>
                    <textarea id="item-description" class="form-control" required></textarea>
                </div>
                
                <!-- Seção para upload de imagem -->
                <div class="form-group">
                    <label>Imagem do Item</label>
                    <div class="image-upload-container">
                        <div class="image-option">
                            <input type="radio" id="image-type-url" name="image-type" value="url" checked>
                            <label for="image-type-url">Usar URL da Imagem</label>
                        </div>
                        
                        <div id="image-url-group">
                            <input type="text" id="item-image-url" class="form-control" placeholder="Cole a URL da imagem">
                        </div>
                        
                        <div class="image-option">
                            <input type="radio" id="image-type-upload" name="image-type" value="upload">
                            <label for="image-type-upload">Carregar do Computador</label>
                        </div>
                        
                        <div id="image-upload-group" style="display: none;">
                            <input type="file" id="item-image-file" class="form-control" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="image-preview" id="image-preview">
                        <div class="image-preview-placeholder">
                            <i class="fas fa-image"></i>
                            <p>Pré-visualização da imagem aparecerá aqui</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Benefícios e Aplicações</label>
                    <div id="benefits-container">
                        <div class="benefit-item">
                            <input type="text" class="form-control benefit-input" placeholder="Benefício (ex: +1 de bônus de ataque)">
                            <button type="button" class="remove-benefit">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" class="add-benefit" id="add-benefit">
                        <i class="fas fa-plus-circle"></i> Adicionar Benefício
                    </button>
                </div>
                
                <div class="form-group">
                    <label for="item-attunement">Sintonização Requerida?</label>
                    <select id="item-attunement" class="form-control">
                        <option value="sim">Sim</option>
                        <option value="nao">Não</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Salvar Item
                </button>
            </form>
        </div>
    </div>
    
    <!-- Firebase SDK com versão modular -->
    <script type="module">
        // Importar módulos do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
        import { 
            getAuth, 
            signInWithEmailAndPassword, 
            signOut, 
            onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            doc, 
            setDoc, 
            deleteDoc, 
            writeBatch,
            onSnapshot,
            addDoc
        } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

        // Configuração do Firebase (use suas credenciais)
        const firebaseConfig = {
            apiKey: "AIzaSyAlOVIkqXGF2mLxE4IrOYmSvChUtNBN_aI",
            authDomain: "itens-strahd.firebaseapp.com",
            projectId: "itens-strahd",
            storageBucket: "itens-strahd.firebasestorage.app",
            messagingSenderId: "923792152854",
            appId: "1:923792152854:web:7ed0d115d749960c97d837",
            measurementId: "G-K3HLYLTZ0D"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Elementos DOM
        const loginSection = document.getElementById('login-section');
        const appContent = document.getElementById('app-content');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const userTypeBtns = document.querySelectorAll('.user-type-btn');
        const currentUserName = document.getElementById('current-user-name');
        const currentUserRole = document.getElementById('current-user-role');
        const loginError = document.getElementById('login-error');
        
        const itemsContainer = document.getElementById('items-container');
        const playerButtons = document.querySelectorAll('.player-btn');
        const addItemBtn = document.getElementById('add-item-btn');
        const itemModal = document.getElementById('item-modal');
        const closeModal = document.getElementById('close-modal');
        const itemForm = document.getElementById('item-form');
        const benefitsContainer = document.getElementById('benefits-container');
        const addBenefitBtn = document.getElementById('add-benefit');
        const modalTitle = document.getElementById('modal-title');
        const imageTypeUrl = document.getElementById('image-type-url');
        const imageTypeUpload = document.getElementById('image-type-upload');
        const imageUrlGroup = document.getElementById('image-url-group');
        const imageUploadGroup = document.getElementById('image-upload-group');
        const imageUrlInput = document.getElementById('item-image-url');
        const imageFileInput = document.getElementById('item-image-file');
        const imagePreview = document.getElementById('image-preview');
        
        // Variáveis globais
        let currentItems = [];
        let editingItemId = null;
        let currentUser = null;
        let userRole = 'master'; // master ou player
        
        // Observar estado de autenticação
        onAuthStateChanged(auth, user => {
            if (user) {
                // Usuário logado
                currentUser = user;
                loginSection.style.display = 'none';
                appContent.style.display = 'block';
                currentUserName.textContent = user.email;
                currentUserRole.textContent = userRole === 'master' ? 'Mestre' : 'Jogador';
                
                // Mostrar botão de adicionar apenas para mestres
                addItemBtn.style.display = userRole === 'master' ? 'block' : 'none';
                
                // Carregar itens
                loadItems();
            } else {
                // Usuário não logado
                loginSection.style.display = 'flex';
                appContent.style.display = 'none';
                currentUser = null;
            }
        });
        
        // Seleção de tipo de usuário
        userTypeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                userTypeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                userRole = btn.dataset.role;
            });
        });
        
        // Login
        loginBtn.addEventListener('click', () => {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            signInWithEmailAndPassword(auth, email, password)
                .then(() => {
                    loginError.style.display = 'none';
                })
                .catch(error => {
                    console.error('Erro de login:', error);
                    loginError.style.display = 'block';
                });
        });
        
        // Logout
        logoutBtn.addEventListener('click', () => {
            signOut(auth);
        });
        
        // Função para carregar itens do Firestore
        async function loadItems() {
            try {
                const querySnapshot = await getDocs(collection(db, "magicItems"));
                currentItems = [];
                querySnapshot.forEach((doc) => {
                    currentItems.push({ id: doc.id, ...doc.data() });
                });
                renderItems();
            } catch (error) {
                console.error("Erro ao carregar itens:", error);
                // Fallback para localStorage
                const savedItems = localStorage.getItem('magicItems');
                if (savedItems) {
                    currentItems = JSON.parse(savedItems);
                    renderItems();
                }
            }
        }
        
        // Função para salvar itens no Firestore
        async function saveItems() {
            try {
                const batch = writeBatch(db);
                const colRef = collection(db, "magicItems");
                
                // Limpar coleção atual
                const querySnapshot = await getDocs(colRef);
                querySnapshot.forEach((doc) => {
                    batch.delete(doc.ref);
                });
                
                // Adicionar todos os itens atuais
                currentItems.forEach(item => {
                    const { id, ...data } = item;
                    const docRef = doc(colRef, id);
                    batch.set(docRef, data);
                });
                
                await batch.commit();
                localStorage.setItem('magicItems', JSON.stringify(currentItems));
            } catch (error) {
                console.error("Erro ao salvar itens:", error);
                // Fallback para localStorage
                localStorage.setItem('magicItems', JSON.stringify(currentItems));
            }
        }
        
        // Inicializar a aplicação
        function init() {
            setupEventListeners();
            
            // Ouvir mudanças em tempo real
            const unsubscribe = onSnapshot(collection(db, "magicItems"), (snapshot) => {
                currentItems = [];
                snapshot.forEach((doc) => {
                    currentItems.push({ id: doc.id, ...doc.data() });
                });
                renderItems(document.querySelector('.player-btn.active').dataset.player);
            });
        }
        
        // Renderizar itens na tela
        function renderItems(player = 'all') {
            itemsContainer.innerHTML = '';
            
            const filteredItems = player === 'all' 
                ? currentItems 
                : currentItems.filter(item => item.player === player);
            
            filteredItems.forEach(item => {
                const itemCard = createItemCard(item);
                itemsContainer.appendChild(itemCard);
            });
        }
        
        // Criar card de item
        function createItemCard(item) {
            const card = document.createElement('div');
            card.className = `item-card ${item.rarity}`;
            card.dataset.id = item.id;
            
            const imageTypes = {
                sword: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><path d="M150,50 L250,50 L300,150 L100,150 Z" fill="%23FFD700"/><path d="M150,50 L150,150 M250,50 L250,150" stroke="%23FF9800" stroke-width="5"/><circle cx="200" cy="100" r="25" fill="%23FF5722"/></svg>`,
                hammer: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><rect x="180" y="60" width="40" height="80" fill="%238B4513"/><rect x="170" y="140" width="60" height="20" fill="%23A52A2A"/><rect x="185" y="40" width="30" height="20" fill="%23D2691E"/></svg>`,
                gauntlet: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><path d="M160,80 C180,60 220,60 240,80 L240,160 C220,180 180,180 160,160 Z" fill="%23795e4a"/><path d="M170,90 C185,75 215,75 230,90" fill="none" stroke="%23e9c46a" stroke-width="5"/></svg>`,
                tattoo: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><circle cx="200" cy="100" r="60" fill="%231a0a0e" stroke="%23c1121f" stroke-width="8"/><path d="M180,90 C200,70 220,70 240,90 M170,120 C200,150 230,150 260,120" stroke="%23c1121f" stroke-width="5" fill="none"/></svg>`,
                cloak: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><path d="M50,100 C100,50 150,150 200,100 C250,50 300,150 350,100" stroke="%23e9c46a" stroke-width="4" fill="none"/><path d="M80,120 C130,70 180,170 230,120 C280,70 330,170 370,120" stroke="%23e9c46a" stroke-width="3" fill="none" stroke-dasharray="5,5"/><circle cx="200" cy="100" r="20" fill="%23e9c46a" opacity="0.6"/></svg>`,
                glove: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><path d="M180,70 C190,50 210,50 220,70 L220,150 C210,170 190,170 180,150 Z" fill="%23111"/><circle cx="200" cy="85" r="15" fill="%23222"/></svg>`,
                ring: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><circle cx="200" cy="100" r="40" fill="none" stroke="%23e9c46a" stroke-width="8"/><circle cx="200" cy="100" r="25" fill="%23e9c46a" opacity="0.6"/></svg>`,
                book: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><rect x="140" y="60" width="120" height="140" fill="%238B4513"/><rect x="145" y="65" width="110" height="130" fill="%23e9c46a"/><path d="M140,60 L260,60 L260,200" stroke="%235d3a71" stroke-width="3"/></svg>`,
                lantern: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><rect x="185" y="80" width="30" height="70" fill="%23795e4a"/><rect x="175" y="150" width="50" height="10" fill="%235d3a71"/><rect x="180" y="70" width="40" height="80" fill="%23FFD700" opacity="0.7"/><circle cx="200" cy="110" r="15" fill="%23FFFFFF" opacity="0.9"/></svg>`,
                staff: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><rect x="195" y="50" width="10" height="100" fill="%238B4513"/><circle cx="200" cy="50" r="15" fill="%23FF5722"/><circle cx="200" cy="100" r="15" fill="%232196F3"/><circle cx="200" cy="150" r="15" fill="%234CAF50"/></svg>`,
                bracer: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200"><rect width="400" height="200" fill="%233a2442"/><rect x="170" y="80" width="60" height="60" fill="%23333" rx="10"/><rect x="175" y="85" width="50" height="50" fill="%23c1121f" rx="5"/></svg>`
            };
            
            let image = '';
            if (item.image.startsWith('data:image')) {
                image = item.image;
            } else if (item.image in imageTypes) {
                image = imageTypes[item.image];
            } else if (item.image) {
                image = item.image;
            } else {
                image = imageTypes.book;
            }
            
            card.innerHTML = `
                <div class="card-header">
                    <span class="item-player">${item.player}</span>
                    <h2 class="item-name">${item.name}</h2>
                    <p class="item-type">${item.type}</p>
                </div>
                <div class="item-image" style="background-image: url('${image}')"></div>
                <div class="item-content">
                    <p class="item-description">${item.description}</p>
                    
                    <div class="benefits-section">
                        <h3 class="benefits-title">Benefícios e Aplicações</h3>
                        <ul class="benefits-list">
                            ${item.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="item-stats">
                        <span class="item-rarity ${item.rarity}">${getRarityName(item.rarity)}</span>
                        <span class="item-attunement">
                            <i class="fas ${item.attunement === 'sim' ? 'fa-skull' : 'fa-times'}"></i> 
                            ${item.attunement === 'sim' ? 'Sintonização' : 'Sem Sintonização'}
                        </span>
                    </div>
                </div>
                <button class="action-button edit-item-btn" data-id="${item.id}">
                    <i class="fas fa-edit"></i>
                </button>
            `;
            
            return card;
        }
        
        // Obter nome da raridade
        function getRarityName(rarity) {
            const names = {
                'incomum': 'Incomum',
                'raro': 'Raro',
                'muito-raro': 'Muito Raro',
                'lendario': 'Lendário'
            };
            return names[rarity] || rarity;
        }
        
        // Configurar listeners de eventos
        function setupEventListeners() {
            // Filtros por jogador
            playerButtons.forEach(button => {
                button.addEventListener('click', function() {
                    playerButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    const player = this.dataset.player;
                    renderItems(player);
                });
            });
            
            // Botão para adicionar novo item
            addItemBtn.addEventListener('click', () => {
                editingItemId = null;
                resetForm();
                modalTitle.textContent = "Adicionar Novo Item Mágico";
                itemModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            });
            
            // Fechar modal
            closeModal.addEventListener('click', () => {
                itemModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Fechar modal ao clicar fora
            window.addEventListener('click', (e) => {
                if (e.target === itemModal) {
                    itemModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Adicionar campo de benefício
            addBenefitBtn.addEventListener('click', addBenefitField);
            
            // Envio do formulário
            itemForm.addEventListener('submit', handleFormSubmit);
            
            // Editar item (CORREÇÃO: usa closest para capturar o botão)
            itemsContainer.addEventListener('click', (e) => {
                const editButton = e.target.closest('.edit-item-btn');
                if (editButton) {
                    const itemId = editButton.dataset.id;
                    editItem(itemId);
                    document.body.style.overflow = 'hidden';
                }
            });
            
            // Eventos para gerenciamento de imagens
            imageTypeUrl.addEventListener('change', toggleImageInput);
            imageTypeUpload.addEventListener('change', toggleImageInput);
            imageUrlInput.addEventListener('input', updateImagePreview);
            imageFileInput.addEventListener('change', updateImagePreview);
        }
        
        // Função para alternar entre URL e upload de arquivo
        function toggleImageInput() {
            if (imageTypeUrl.checked) {
                imageUrlGroup.style.display = 'block';
                imageUploadGroup.style.display = 'none';
                updateImagePreview();
            } else {
                imageUrlGroup.style.display = 'none';
                imageUploadGroup.style.display = 'block';
            }
        }
        
        // Atualizar pré-visualização da imagem
        function updateImagePreview() {
            if (imageTypeUrl.checked && imageUrlInput.value) {
                imagePreview.style.backgroundImage = `url('${imageUrlInput.value}')`;
                imagePreview.innerHTML = '';
            } else if (imageTypeUpload.checked && imageFileInput.files && imageFileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.style.backgroundImage = `url('${e.target.result}')`;
                    imagePreview.innerHTML = '';
                };
                reader.readAsDataURL(imageFileInput.files[0]);
            } else {
                imagePreview.style.backgroundImage = '';
                if (!imagePreview.querySelector('.image-preview-placeholder')) {
                    imagePreview.innerHTML = `
                        <div class="image-preview-placeholder">
                            <i class="fas fa-image"></i>
                            <p>Pré-visualização da imagem aparecerá aqui</p>
                        </div>
                    `;
                }
            }
        }
        
        // Adicionar campo de benefício
        function addBenefitField() {
            const div = document.createElement('div');
            div.className = 'benefit-item';
            div.innerHTML = `
                <input type="text" class="form-control benefit-input" placeholder="Benefício (ex: +1 de bônus de ataque)">
                <button type="button" class="remove-benefit">
                    <i class="fas fa-times"></i>
                </button>
            `;
            benefitsContainer.appendChild(div);
            
            // Adicionar listener para remover benefício
            div.querySelector('.remove-benefit').addEventListener('click', function() {
                if (benefitsContainer.children.length > 1) {
                    this.parentElement.remove();
                }
            });
        }
        
        // Resetar formulário
        function resetForm() {
            itemForm.reset();
            benefitsContainer.innerHTML = `
                <div class="benefit-item">
                    <input type="text" class="form-control benefit-input" placeholder="Benefício (ex: +1 de bônus de ataque)">
                    <button type="button" class="remove-benefit">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            // Resetar campos de imagem
            imageTypeUrl.checked = true;
            imageTypeUpload.checked = false;
            imageUrlGroup.style.display = 'block';
            imageUploadGroup.style.display = 'none';
            imageUrlInput.value = '';
            imageFileInput.value = '';
            imagePreview.style.backgroundImage = '';
            
            // Restaurar placeholder
            if (!imagePreview.querySelector('.image-preview-placeholder')) {
                imagePreview.innerHTML = `
                    <div class="image-preview-placeholder">
                        <i class="fas fa-image"></i>
                        <p>Pré-visualização da imagem aparecerá aqui</p>
                    </div>
                `;
            }
        }
        
        // Editar item
        function editItem(id) {
            const item = currentItems.find(item => item.id === id);
            if (!item) return;
            
            editingItemId = id;
            
            // Preencher formulário
            document.getElementById('item-id').value = item.id;
            document.getElementById('item-name').value = item.name;
            document.getElementById('item-player').value = item.player;
            document.getElementById('item-type').value = item.type;
            document.getElementById('item-rarity').value = item.rarity;
            document.getElementById('item-description').value = item.description;
            document.getElementById('item-attunement').value = item.attunement;
            
            // Preencher campos de imagem
            if (item.image.startsWith('data:image')) {
                // Se for uma imagem em base64 (upload)
                imageTypeUpload.checked = true;
                toggleImageInput();
                // Não podemos redefinir o input file, mas podemos mostrar a imagem
                imagePreview.style.backgroundImage = `url('${item.image}')`;
                imagePreview.innerHTML = '';
            } else if (item.image in {
                sword: 1, hammer: 1, gauntlet: 1, tattoo: 1, cloak: 1, 
                glove: 1, ring: 1, book: 1, lantern: 1, staff: 1, bracer: 1
            }) {
                // Se for uma imagem padrão, usar o tipo padrão
                imageTypeUrl.checked = true;
                toggleImageInput();
                imageUrlInput.value = '';
                // Usaremos o placeholder padrão, pois não temos URL
                imagePreview.innerHTML = `
                    <div class="image-preview-placeholder">
                        <i class="fas fa-image"></i>
                        <p>Imagem padrão será usada</p>
                    </div>
                `;
            } else if (item.image) {
                // Se for uma URL
                imageTypeUrl.checked = true;
                toggleImageInput();
                imageUrlInput.value = item.image;
                updateImagePreview();
            } else {
                // Sem imagem
                imageTypeUrl.checked = true;
                toggleImageInput();
                imageUrlInput.value = '';
                updateImagePreview();
            }
            
            // Preencher benefícios
            benefitsContainer.innerHTML = '';
            item.benefits.forEach(benefit => {
                const div = document.createElement('div');
                div.className = 'benefit-item';
                div.innerHTML = `
                    <input type="text" class="form-control benefit-input" value="${benefit}">
                    <button type="button" class="remove-benefit">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                benefitsContainer.appendChild(div);
                
                // Adicionar listener para remover benefício
                div.querySelector('.remove-benefit').addEventListener('click', function() {
                    if (benefitsContainer.children.length > 1) {
                        this.parentElement.remove();
                    }
                });
            });
            
            modalTitle.textContent = "Editar Item Mágico";
            itemModal.style.display = 'flex';
        }
        
        // Manipular envio do formulário
        async function handleFormSubmit(e) {
            e.preventDefault();
            
            // Obter valores do formulário
            const id = editingItemId || Date.now().toString();
            const name = document.getElementById('item-name').value;
            const player = document.getElementById('item-player').value;
            const type = document.getElementById('item-type').value;
            const rarity = document.getElementById('item-rarity').value;
            const description = document.getElementById('item-description').value;
            const attunement = document.getElementById('item-attunement').value;
            
            // Obter imagem do item
            let image = '';
            if (imageTypeUpload.checked && imageFileInput.files && imageFileInput.files[0]) {
                const file = imageFileInput.files[0];
                const reader = new FileReader();
                reader.onload = function(event) {
                    image = event.target.result;
                    saveItem(id, name, player, type, rarity, description, attunement, image);
                };
                reader.readAsDataURL(file);
                return;
            } else if (imageTypeUrl.checked && imageUrlInput.value) {
                image = imageUrlInput.value;
            } else {
                image = 'book';
            }
            
            saveItem(id, name, player, type, rarity, description, attunement, image);
        }
        
        // Função para salvar o item
        async function saveItem(id, name, player, type, rarity, description, attunement, image) {
            // Obter benefícios
            const benefits = [];
            document.querySelectorAll('.benefit-input').forEach(input => {
                if (input.value.trim() !== '') {
                    benefits.push(input.value.trim());
                }
            });
            
            // Criar novo objeto de item
            const newItem = {
                id,
                player,
                name,
                type,
                rarity,
                description,
                benefits,
                attunement,
                image
            };
            
            // Atualizar ou adicionar item
            if (editingItemId) {
                const index = currentItems.findIndex(item => item.id === editingItemId);
                if (index !== -1) {
                    currentItems[index] = newItem;
                }
            } else {
                currentItems.push(newItem);
            }
            
            // Salvar e renderizar
            await saveItems();
            renderItems(document.querySelector('.player-btn.active').dataset.player);
            
            // Fechar modal
            itemModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // Iniciar a aplicação quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
